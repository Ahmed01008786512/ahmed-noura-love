<!DOCTYPE html>
<html>
<head>
  <title>Ahmed & Noura ğŸ’–</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Pacifico&display=swap');

    body {
      margin:0;
      font-family:'Arial', sans-serif;
      height:100vh;
      display:flex;
      flex-direction:column;
      background: url('https://i.postimg.cc/P5B18wR1/IMG-20260125-WA0028.jpg') no-repeat center center;
      background-size: cover;
      color:white;
      overflow:hidden;
    }

    /* Overlay Ø®ÙÙŠÙ Ø¹Ø´Ø§Ù† ÙˆØ¶ÙˆØ­ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
    body::before {
      content:'';
      position:absolute;
      top:0; left:0; width:100%; height:100%;
      background: rgba(0,0,0,0.5);
      z-index:0;
    }

    header{
      text-align:center;
      padding:20px;
      font-family:'Pacifico', cursive;
      font-size:32px;
      color:#ff4081;
      position:relative;
      z-index:2;
      text-shadow:2px 2px 6px #000;
    }

    #messages{
      flex:1;
      overflow-y:auto;
      padding:15px;
      display:flex;
      flex-direction:column;
      gap:5px;
      position:relative;
      z-index:2;
    }

    .msg{
      padding:10px 15px;
      border-radius:20px;
      max-width:70%;
      word-break: break-word;
      font-size:15px;
      position:relative;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }

    .msg.ahmed{
      background:#ff4081;
      align-self:flex-end;
    }

    .msg.noura{
      background:#7c4dff;
      align-self:flex-start;
    }

    .inputBox{
      display:flex;
      padding:10px;
      background: rgba(0,0,0,0.6);
      gap:8px;
      z-index:2;
    }

    input[type=text]{
      flex:1;
      padding:10px;
      border-radius:20px;
      border:none;
      font-size:15px;
    }

    #fileInput{
      width:40px;
      height:40px;
      padding:0;
    }

    button{
      padding:10px 15px;
      border:none;
      border-radius:20px;
      background:#ff4081;
      color:white;
      font-weight:bold;
      cursor:pointer;
    }

    /* ØªÙˆÙ‡Ø¬ ÙƒÙ„Ù…Ø© Ø§Ù„Ø­Ø¨ */
    #loveGlow{
      position:absolute;
      bottom:20px;
      width:100%;
      text-align:center;
      font-size:24px;
      font-family:'Pacifico', cursive;
      color:#ff4081;
      text-shadow: 0 0 8px #ff80ab, 0 0 16px #ff4081, 0 0 24px #ff80ab;
      z-index:2;
      pointer-events:none;
    }
  </style>
</head>
<body>

<script>
  // Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø© Ø¨ÙƒÙ„Ù…Ø© Ø³Ø±
  const correctPassword = "Ø¨Ø­Ø¨Ùƒ";
  const input = prompt("Noura tell me the password:");
  if(input !== correctPassword){
    document.body.innerHTML = "<h1 style='text-align:center; margin-top:50vh;'>Access Denied</h1>";
    throw "Wrong password!";
  }
</script>

<header>Ahmed & Noura ğŸ’–</header>
<div id="messages"></div>

<div class="inputBox">
  <input id="messageInput" type="text" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø© Ø­Ø¨...">
  <input type="file" id="fileInput">
  <button onclick="sendMessage()">ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„</button>
  <button id="recordBtn">ğŸ¤ ØªØ³Ø¬ÙŠÙ„ ØµÙˆØª</button>
</div>

<div id="loveGlow">ğŸ’– Ø¨Ø­Ø¨Ùƒ ÙŠØ§ Ù†ÙˆØ±Ø§ ğŸ’–</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
  import { getStorage, ref as sRef, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDhuXjM-H9bSymsU01sz27_5prXXTX7rYU",
    authDomain: "ahmed-noura-love.firebaseapp.com",
    databaseURL: "https://ahmed-noura-love-default-rtdb.firebaseio.com",
    projectId: "ahmed-noura-love",
    storageBucket: "ahmed-noura-love.firebasestorage.app",
    messagingSenderId: "791080256640",
    appId: "1:791080256640:web:91d6fcb85c2838a9619265"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const storage = getStorage(app);

  const roomId = "ahmed-noura-private";
  const messagesRef = ref(db, "rooms/" + roomId);
  const messagesDiv = document.getElementById("messages");

  // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø£Ùˆ ØµÙˆØ±Ø©
  window.sendMessage = async function() {
    const input = document.getElementById("messageInput");
    const fileInput = document.getElementById("fileInput");
    let content = input.value.trim();

    if(fileInput.files.length > 0){
      const file = fileInput.files[0];
      const storageRef = sRef(storage, `rooms/${roomId}/${Date.now()}_${file.name}`);
      await uploadBytes(storageRef, file);
      const url = await getDownloadURL(storageRef);
      content = `<img src="${url}" style="max-width:200px; border-radius:10px;">`;
      fileInput.value = "";
    }

    if(content !== ""){
      push(messagesRef, { text: content, sender:'ahmed' });
      input.value = "";
    }
  }

  // Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
  onChildAdded(messagesRef, (data)=>{
    const msgData = data.val();
    const msg = document.createElement("div");
    msg.className="msg " + (msgData.sender || 'noura');
    msg.innerHTML = msgData.text;
    messagesDiv.appendChild(msg);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  });

  // ØªØ³Ø¬ÙŠÙ„ ØµÙˆØª ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡
  let mediaRecorder;
  let audioChunks = [];
  const recordBtn = document.getElementById("recordBtn");

  recordBtn.onclick = async function() {
    if(recordBtn.innerText === "ğŸ¤ ØªØ³Ø¬ÙŠÙ„ ØµÙˆØª"){
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      mediaRecorder = new MediaRecorder(stream);
      audioChunks = [];
      mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
      mediaRecorder.onstop = async () => {
        const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
        const storageRef = sRef(storage, `rooms/${roomId}/${Date.now()}_voice.webm`);
        await uploadBytes(storageRef, audioBlob);
        const url = await getDownloadURL(storageRef);
        push(messagesRef, { text: `<audio controls src="${url}"></audio>`, sender:'ahmed' });
      };
      mediaRecorder.start();
      recordBtn.innerText = "â¹ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ³Ø¬ÙŠÙ„";
    } else {
      mediaRecorder.stop();
      recordBtn.innerText = "ğŸ¤ ØªØ³Ø¬ÙŠÙ„ ØµÙˆØª";
    }
  }
</script>

</body>
</html>
